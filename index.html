<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="utf-8">
    <title>Avanza Trading Helper - Professionell Stop Loss & Take Profit Kalkylator</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="Avanza Trading Helper - Beräkna Stop Loss, Take Profit och Risk/Reward" name="description">
    <meta content="avanza, trading, stop loss, take profit, kalkylator" name="keywords">

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&family=Roboto:wght@400;500;700;900&display=swap" rel="stylesheet">

    <!-- Icon Font Stylesheet -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Animate CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.js"></script>

    <style>
        /********** Template CSS **********/
        :root {
            --primary: #00D084;
            --secondary: #0D2735;
            --light: #F8F8F8;
            --dark: #0D2735;
        }

        body {
            font-family: 'Inter', sans-serif;
            font-weight: 400;
            color: #E0E0E0;
            background: #0D1F2D;
            background-attachment: fixed;
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: 'Roboto', sans-serif;
            font-weight: 700;
            color: #FFFFFF;
        }

        .btn {
            font-weight: 500;
            transition: .5s;
        }

        .btn-primary {
            color: #FFFFFF;
            background-color: var(--primary);
            border-color: var(--primary);
        }

        .btn-primary:hover {
            background-color: #00B871;
            border-color: #00B871;
        }

        .btn-square {
            width: 38px;
            height: 38px;
        }

        .btn-sm-square {
            width: 32px;
            height: 32px;
        }

        .btn-lg-square {
            width: 48px;
            height: 48px;
        }

        .btn-square,
        .btn-sm-square,
        .btn-lg-square {
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: normal;
        }

        .back-to-top {
            position: fixed;
            display: none;
            right: 30px;
            bottom: 30px;
            z-index: 99;
        }

        /*** Spinner ***/
        #spinner {
            opacity: 0;
            visibility: hidden;
            transition: opacity .5s ease-out, visibility 0s linear .5s;
            z-index: 99999;
        }

        #spinner.show {
            transition: opacity .5s ease-out, visibility 0s linear 0s;
            visibility: visible;
            opacity: 1;
        }

        /*** Topbar ***/
        .topbar {
            background: rgba(26, 47, 61, 0.8);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .topbar .text-muted {
            color: #B0B0B0 !important;
        }

        .topbar .text-dark {
            color: #E0E0E0 !important;
        }

        .topbar .dropdown-toggle::after {
            border: none;
            content: "\f107";
            font-family: "Font Awesome 5 Free";
            font-weight: 900;
            vertical-align: middle;
            margin-left: 8px;
        }

        /*** Navbar ***/
        .navbar {
            transition: .5s;
            background: rgba(26, 47, 61, 0.95);
            backdrop-filter: blur(10px);
        }

        .navbar.sticky-top {
            box-shadow: 0 .5rem 1rem rgba(0, 0, 0, 0.3);
        }

        .navbar .navbar-brand {
            height: 75px;
            display: flex;
            align-items: center;
        }

        .navbar .navbar-brand h1 {
            margin: 0;
            color: #FFFFFF;
        }

        .navbar .navbar-nav .nav-link {
            margin-right: 30px;
            padding: 25px 0;
            color: #E0E0E0;
            font-weight: 500;
            text-transform: uppercase;
            outline: none;
        }

        .navbar .navbar-nav .nav-link:hover,
        .navbar .navbar-nav .nav-link.active {
            color: var(--primary);
        }

        .navbar .dropdown-toggle::after {
            border: none;
            content: "\f107";
            font-family: "Font Awesome 5 Free";
            font-weight: 900;
            vertical-align: middle;
            margin-left: 8px;
        }

        @media (max-width: 991.98px) {
            .navbar .navbar-nav .nav-link  {
                margin-right: 0;
                padding: 10px 0;
            }

            .navbar .navbar-nav {
                border-top: 1px solid #EEEEEE;
            }
        }

        @media (min-width: 992px) {
            .navbar .nav-item .dropdown-menu {
                display: block;
                border: none;
                margin-top: 0;
                top: 150%;
                opacity: 0;
                visibility: hidden;
                transition: .5s;
            }

            .navbar .nav-item:hover .dropdown-menu {
                top: 100%;
                visibility: visible;
                transition: .5s;
                opacity: 1;
            }
        }

        /*** Hero Header ***/
        .hero-header {
            background: linear-gradient(rgba(13, 39, 53, 0.95), rgba(13, 39, 53, 0.95)), url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1920 1080"><rect fill="%230D2735" width="1920" height="1080"/></svg>') center center no-repeat;
            background-size: cover;
            padding: 100px 0 50px 0;
        }

        .hero-header h1 {
            color: #FFFFFF;
            font-size: 48px;
            margin-bottom: 20px;
        }

        .hero-header p {
            color: rgba(255, 255, 255, 0.8);
            font-size: 18px;
        }

        /*** Section Title ***/
        .section-title {
            position: relative;
            display: inline-block;
            color: var(--primary);
        }

        .section-title::before {
            position: absolute;
            content: "";
            width: 45px;
            height: 2px;
            top: 50%;
            left: -55px;
            margin-top: -1px;
            background: var(--primary);
        }

        .section-title::after {
            position: absolute;
            content: "";
            width: 45px;
            height: 2px;
            top: 50%;
            right: -55px;
            margin-top: -1px;
            background: var(--primary);
        }

        .section-title.text-start::before,
        .section-title.text-end::after {
            display: none;
        }

        .text-muted {
            color: #B0B0B0 !important;
        }

        /*** Card Styles ***/
        .card {
            border: none;
            border-radius: 10px;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
            transition: .5s;
            background: rgba(26, 47, 61, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .card:hover {
            box-shadow: 0 0 45px rgba(0, 208, 132, 0.3);
            transform: translateY(-5px);
        }

        /*** Stock Search Section ***/
        .stock-search-card {
            background: rgba(0, 208, 132, 0.05);
            border-left: 4px solid var(--primary);
        }

        .search-input {
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            padding: 12px 20px;
            font-size: 16px;
            transition: all 0.3s;
            background: rgba(13, 31, 45, 0.5);
            color: #FFFFFF;
        }

        .search-input::placeholder {
            color: #B0B0B0;
        }

        .search-input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 0.2rem rgba(0, 208, 132, 0.25);
            background: rgba(13, 31, 45, 0.7);
            color: #FFFFFF;
        }

        /*** Stock Result ***/
        .stock-result {
            display: none;
            background: rgba(0, 208, 132, 0.1);
            border: 2px solid var(--primary);
            border-radius: 10px;
            padding: 25px;
            margin-top: 20px;
            animation: fadeInUp 0.5s;
        }

        .stock-result.show {
            display: block;
        }

        .stock-ticker {
            font-size: 28px;
            font-weight: 700;
            color: #FFFFFF;
            font-family: 'Roboto', monospace;
        }

        .stock-price {
            font-size: 32px;
            font-weight: 700;
            color: var(--primary);
        }

        .stock-change {
            font-size: 18px;
            font-weight: 600;
            padding: 8px 16px;
            border-radius: 6px;
        }

        .stock-change.positive {
            background: rgba(0, 208, 132, 0.2);
            color: var(--primary);
        }

        .stock-change.negative {
            background: rgba(255, 107, 107, 0.2);
            color: #FF6B6B;
        }

        /*** Chart ***/
        .chart-container {
            position: relative;
            height: 350px;
            background: rgba(13, 31, 45, 0.6);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .period-btn {
            padding: 8px 20px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            background: rgba(13, 31, 45, 0.5);
            color: #E0E0E0;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
        }

        .period-btn.active {
            background: var(--primary);
            border-color: var(--primary);
            color: #FFFFFF;
        }

        .period-btn:hover:not(.active) {
            border-color: var(--primary);
            color: var(--primary);
            background: rgba(0, 208, 132, 0.1);
        }

        /*** Risk Selector ***/
        .risk-option {
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: rgba(13, 31, 45, 0.5);
        }

        .risk-option:hover {
            border-color: var(--primary);
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0, 208, 132, 0.3);
            background: rgba(13, 31, 45, 0.7);
        }

        .risk-option.active {
            border-color: var(--primary);
            background: rgba(0, 208, 132, 0.15);
            box-shadow: 0 0 0 4px rgba(0, 208, 132, 0.2);
        }

        .risk-label {
            font-weight: 600;
            color: #E0E0E0;
            margin-bottom: 5px;
        }

        .risk-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary);
        }

        /*** Results ***/
        .results-card {
            display: none;
            background: linear-gradient(135deg, rgba(0, 208, 132, 0.05) 0%, rgba(13, 39, 53, 0.05) 100%);
            border-left: 4px solid var(--primary);
            padding: 30px;
            border-radius: 10px;
            margin-top: 30px;
        }

        .results-card.show {
            display: block;
            animation: fadeInUp 0.5s;
        }

        .result-item {
            background: rgba(13, 31, 45, 0.6);
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .result-label {
            color: #B0B0B0;
            font-size: 14px;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .result-value {
            font-size: 24px;
            font-weight: 700;
            font-family: 'Roboto', monospace;
            color: #FFFFFF;
        }

        .result-value.positive {
            color: var(--primary);
        }

        .result-value.negative {
            color: #FF6B6B;
        }

        /*** Guide Section ***/
        .guide-card {
            background: rgba(26, 47, 61, 0.6);
            border-left: 4px solid var(--primary);
            padding: 25px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .guide-step {
            background: rgba(13, 31, 45, 0.6);
            padding: 15px 20px;
            border-radius: 6px;
            margin-bottom: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: #E0E0E0;
        }

        .guide-value {
            color: var(--primary);
            font-weight: 700;
            font-family: 'Roboto', monospace;
        }

        /*** Loading Spinner ***/
        .loading-spinner {
            text-align: center;
            padding: 40px;
        }

        .spinner-border-custom {
            width: 3rem;
            height: 3rem;
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /*** Footer ***/
        .footer {
            background: var(--dark);
            color: rgba(255, 255, 255, 0.7);
        }

        .footer .btn.btn-link {
            display: block;
            margin-bottom: 5px;
            padding: 0;
            text-align: left;
            color: rgba(255, 255, 255, 0.7);
            font-weight: normal;
            text-decoration: none;
            transition: .3s;
        }

        .footer .btn.btn-link::before {
            position: relative;
            content: "\f105";
            font-family: "Font Awesome 5 Free";
            font-weight: 900;
            color: rgba(255, 255, 255, 0.7);
            margin-right: 10px;
        }

        .footer .btn.btn-link:hover {
            color: var(--primary);
            letter-spacing: 1px;
            box-shadow: none;
        }

        .footer .btn.btn-link:hover::before {
            color: var(--primary);
        }

        .copyright {
            background: rgba(0, 0, 0, 0.2);
        }

        /* Bootstrap Nav Pills Dark Theme */
        .nav-pills .nav-link {
            background: rgba(13, 31, 45, 0.5);
            color: #E0E0E0;
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin: 0 5px;
        }

        .nav-pills .nav-link:hover {
            background: rgba(0, 208, 132, 0.1);
            color: var(--primary);
        }

        .nav-pills .nav-link.active {
            background: var(--primary);
            color: #FFFFFF;
        }

        /* Alert Dark Theme */
        .alert-warning {
            background: rgba(255, 193, 7, 0.15);
            border: 1px solid rgba(255, 193, 7, 0.3);
            color: #E0E0E0;
        }

        /* Form labels */
        .form-label {
            color: #E0E0E0;
        }
    </style>
</head>

<body>
    <!-- Spinner Start -->
    <div id="spinner" class="show bg-white position-fixed translate-middle w-100 vh-100 top-50 start-50 d-flex align-items-center justify-content-center">
        <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;" role="status">
            <span class="sr-only">Laddar...</span>
        </div>
    </div>
    <!-- Spinner End -->

    <!-- Topbar Start -->
    <div class="container-fluid topbar bg-light px-5 d-none d-lg-block">
        <div class="row gx-0 align-items-center">
            <div class="col-lg-8 text-center text-lg-start mb-2 mb-lg-0">
                <div class="d-flex flex-wrap">
                    <span class="text-muted small me-4"><i class="fas fa-chart-line text-primary me-2"></i>Professionell Trading Kalkylator</span>
                    <span class="text-muted small me-0"><i class="fas fa-shield-alt text-primary me-2"></i>100% Gratis Verktyg</span>
                </div>
            </div>
            <div class="col-lg-4 text-center text-lg-end">
                <div class="d-inline-flex align-items-center" style="height: 45px;">
                    <small class="me-3 text-dark"><i class="fa fa-calculator text-primary me-2"></i>Beräkna SL/TP</small>
                </div>
            </div>
        </div>
    </div>
    <!-- Topbar End -->

    <!-- Navbar Start -->
    <div class="container-fluid position-relative p-0">
        <nav class="navbar navbar-expand-lg navbar-light px-4 px-lg-5 py-3 py-lg-0">
            <a href="index.html" class="navbar-brand p-0">
                <h1 class="text-primary"><i class="fas fa-chart-line me-3"></i>Avanza Helper</h1>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse">
                <span class="fa fa-bars"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarCollapse">
                <div class="navbar-nav ms-auto py-0">
                    <a href="#home" class="nav-item nav-link active">Hem</a>
                    <a href="#calculator" class="nav-item nav-link">Kalkylator</a>
                    <a href="#guides" class="nav-item nav-link">Guider</a>
                </div>
                <a href="#calculator" class="btn btn-primary rounded-pill py-2 px-4 my-3 my-lg-0 flex-shrink-0">Kom Igång</a>
            </div>
        </nav>

        <!-- Hero Header Start -->
        <div class="hero-header">
            <div class="container">
                <div class="row g-5 align-items-center">
                    <div class="col-lg-6 text-center text-lg-start">
                        <h4 class="text-primary text-uppercase fw-bold mb-4 animate__animated animate__fadeInDown">Välkommen till Avanza Trading Helper</h4>
                        <h1 class="display-4 text-white mb-4 animate__animated animate__fadeInUp">Maximera Din Avkastning med Smart Riskhantering</h1>
                        <p class="text-white-50 mb-4 pb-3 animate__animated animate__fadeInUp">Beräkna exakta Stop Loss och Take Profit nivåer för dina aktieaffärer på Avanza. Professionellt verktyg för seriösa investerare.</p>
                        <div class="d-flex align-items-center justify-content-center justify-content-lg-start animate__animated animate__fadeInUp">
                            <a href="#calculator" class="btn btn-primary rounded-pill py-3 px-5 me-3">Börja Beräkna</a>
                            <a href="#guides" class="btn btn-outline-light rounded-pill py-3 px-5">Läs Guider</a>
                        </div>
                    </div>
                    <div class="col-lg-6 text-center text-lg-end">
                        <div class="animate__animated animate__fadeInRight">
                            <i class="fas fa-calculator fa-10x text-primary opacity-50"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Hero Header End -->
    </div>
    <!-- Navbar End -->

    <!-- Stock Search Section Start -->
    <div class="container-fluid py-5" id="home">
        <div class="container py-5">
            <div class="row g-5">
                <div class="col-lg-12">
                    <div class="card stock-search-card p-4">
                        <div class="text-center mb-4">
                            <h5 class="section-title text-center text-primary">Sök Aktier</h5>
                            <h2 class="mb-3">Hämta Aktuellt Pris & Historik</h2>
                            <p class="text-muted">Sök efter USA-aktier och få aktuellt pris + interaktiv graf automatiskt</p>
                        </div>

                        <div class="row g-3">
                            <div class="col-lg-8 col-md-7">
                                <input 
                                    type="text" 
                                    id="searchInput" 
                                    class="form-control search-input" 
                                    placeholder="Ange ticker (t.ex. AAPL, TSLA, MSFT, GOOGL...)"
                                    style="text-transform: uppercase;"
                                >
                            </div>
                            <div class="col-lg-4 col-md-5">
                                <button class="btn btn-primary w-100 py-3" onclick="searchStock()">
                                    <i class="fas fa-search me-2"></i>Sök Aktie
                                </button>
                            </div>
                        </div>

                        <div class="alert alert-info mt-3 mb-0" style="background: rgba(0, 208, 132, 0.15); border: 1px solid rgba(0, 208, 132, 0.3); color: #E0E0E0;">
                            <i class="fas fa-info-circle me-2"></i>
                            <strong>Tips:</strong> Använder Alpha Vantage API för realtidsdata. Max 25 sökningar/dag med gratis API.
                        </div>

                        <!-- Stock Result -->
                        <div id="stockResult" class="stock-result">
                            <!-- Result will be displayed here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Stock Search Section End -->

    <!-- Calculator Section Start -->
    <div class="container-fluid py-5" id="calculator" style="background: rgba(13, 31, 45, 0.5);">
        <div class="container py-5">
            <div class="text-center mb-5">
                <h5 class="section-title text-center text-primary">Kalkylator</h5>
                <h2 class="mb-3">Beräkna Stop Loss & Take Profit</h2>
                <p class="text-muted">Fyll i dina värden och få exakta nivåer för dina orders</p>
            </div>

            <div class="row g-5">
                <div class="col-lg-6">
                    <div class="card p-4">
                        <h4 class="mb-4"><i class="fas fa-edit text-primary me-2"></i>Fyll i Uppgifter</h4>
                        
                        <div class="mb-3">
                            <label for="buyPrice" class="form-label">Inköpspris (kr)</label>
                            <input type="number" class="form-control search-input" id="buyPrice" step="0.01" placeholder="100.00">
                            <small class="text-muted">Pris per aktie/certifikat</small>
                        </div>

                        <div class="mb-3">
                            <label for="quantity" class="form-label">Antal aktier/certifikat</label>
                            <input type="number" class="form-control search-input" id="quantity" placeholder="100">
                            <small class="text-muted">Totalt antal som ska köpas</small>
                        </div>

                        <div class="mb-4">
                            <label class="form-label">Välj Risknivå</label>
                            <div class="row g-2">
                                <div class="col-6 col-md-4">
                                    <div class="risk-option active" onclick="selectRisk(1)">
                                        <div class="risk-label">Låg</div>
                                        <div class="risk-value">1%</div>
                                    </div>
                                </div>
                                <div class="col-6 col-md-4">
                                    <div class="risk-option" onclick="selectRisk(2)">
                                        <div class="risk-label">Måttlig</div>
                                        <div class="risk-value">2%</div>
                                    </div>
                                </div>
                                <div class="col-6 col-md-4">
                                    <div class="risk-option" onclick="selectRisk(3)">
                                        <div class="risk-label">Medium</div>
                                        <div class="risk-value">3%</div>
                                    </div>
                                </div>
                                <div class="col-6 col-md-6">
                                    <div class="risk-option" onclick="selectRisk(4)">
                                        <div class="risk-label">Hög</div>
                                        <div class="risk-value">4%</div>
                                    </div>
                                </div>
                                <div class="col-12 col-md-6">
                                    <div class="risk-option" onclick="selectRisk(5)">
                                        <div class="risk-label">Mycket Hög</div>
                                        <div class="risk-value">5%</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <button class="btn btn-primary w-100 py-3" onclick="calculate()">
                            <i class="fas fa-calculator me-2"></i>Beräkna Nivåer
                        </button>
                    </div>
                </div>

                <div class="col-lg-6">
                    <!-- Results Card -->
                    <div id="results" class="results-card">
                        <h4 class="mb-4"><i class="fas fa-chart-bar text-primary me-2"></i>Beräknade Nivåer</h4>
                        
                        <div class="row g-3">
                            <div class="col-md-6">
                                <div class="result-item">
                                    <div class="result-label">Total Investering</div>
                                    <div class="result-value" id="totalInvestment">0 kr</div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="result-item">
                                    <div class="result-label">Risk/Reward</div>
                                    <div class="result-value" id="ratio">1:0</div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="result-item">
                                    <div class="result-label">SL Trigger</div>
                                    <div class="result-value negative" id="slTrigger">0 kr</div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="result-item">
                                    <div class="result-label">SL Limit</div>
                                    <div class="result-value negative" id="slLimit">0 kr</div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="result-item">
                                    <div class="result-label">Max Förlust</div>
                                    <div class="result-value negative" id="maxLoss">0 kr</div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="result-item">
                                    <div class="result-label">TP Limit</div>
                                    <div class="result-value positive" id="tpLimit">0 kr</div>
                                </div>
                            </div>
                            <div class="col-12">
                                <div class="result-item">
                                    <div class="result-label">Max Vinst</div>
                                    <div class="result-value positive" id="maxProfit">0 kr</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Calculator Section End -->

    <!-- Guides Section Start -->
    <div class="container-fluid py-5" id="guides">
        <div class="container py-5">
            <div class="text-center mb-5">
                <h5 class="section-title text-center text-primary">Guider</h5>
                <h2 class="mb-3">Steg-för-steg Instruktioner</h2>
                <p class="text-muted">Följ dessa enkla steg för att sätta dina orders på Avanza</p>
            </div>

            <ul class="nav nav-pills mb-4 justify-content-center" id="pills-tab" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="pills-sl-tab" data-bs-toggle="pill" data-bs-target="#pills-sl" type="button">
                        <i class="fas fa-shield-alt me-2"></i>Stop Loss
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="pills-tp-tab" data-bs-toggle="pill" data-bs-target="#pills-tp" type="button">
                        <i class="fas fa-bullseye me-2"></i>Take Profit
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="pills-combined-tab" data-bs-toggle="pill" data-bs-target="#pills-combined" type="button">
                        <i class="fas fa-check-double me-2"></i>Kombinerad
                    </button>
                </li>
            </ul>

            <div class="tab-content" id="pills-tabContent">
                <!-- Stop Loss Guide -->
                <div class="tab-pane fade show active" id="pills-sl">
                    <div class="row justify-content-center">
                        <div class="col-lg-8">
                            <div class="guide-card">
                                <h4 class="text-primary mb-4"><i class="fas fa-list-ol me-2"></i>Sätt Stop Loss Order</h4>
                                
                                <div class="guide-step">
                                    <strong>Steg 1:</strong> Välj ordertyp: <span class="guide-value">Stop Loss</span>
                                </div>
                                <div class="guide-step">
                                    <strong>Steg 2:</strong> Trigger-kurs: <span class="guide-value" id="guide-sl-trigger">0 kr</span>
                                </div>
                                <div class="guide-step">
                                    <strong>Steg 3:</strong> Limit-kurs: <span class="guide-value" id="guide-sl-limit">0 kr</span>
                                </div>
                                <div class="guide-step">
                                    <strong>Steg 4:</strong> Antal: <span class="guide-value" id="guide-sl-quantity">0 st</span>
                                </div>
                                <div class="guide-step">
                                    <strong>Steg 5:</strong> Giltighetstid: <span class="guide-value">Tills vidare</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Take Profit Guide -->
                <div class="tab-pane fade" id="pills-tp">
                    <div class="row justify-content-center">
                        <div class="col-lg-8">
                            <div class="guide-card">
                                <h4 class="text-primary mb-4"><i class="fas fa-list-ol me-2"></i>Sätt Take Profit Order</h4>
                                
                                <div class="guide-step">
                                    <strong>Steg 1:</strong> Välj ordertyp: <span class="guide-value">Limit</span>
                                </div>
                                <div class="guide-step">
                                    <strong>Steg 2:</strong> Limit-kurs: <span class="guide-value" id="guide-tp-limit">0 kr</span>
                                </div>
                                <div class="guide-step">
                                    <strong>Steg 3:</strong> Antal: <span class="guide-value" id="guide-tp-quantity">0 st</span>
                                </div>
                                <div class="guide-step">
                                    <strong>Steg 4:</strong> Giltighetstid: <span class="guide-value">Tills vidare</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Combined Guide -->
                <div class="tab-pane fade" id="pills-combined">
                    <div class="row justify-content-center">
                        <div class="col-lg-8">
                            <div class="guide-card">
                                <h4 class="text-primary mb-4"><i class="fas fa-list-ol me-2"></i>Köp + Sätt Båda Orders</h4>
                                
                                <h5 class="mt-4 mb-3">Del 1: Köp Aktien</h5>
                                <div class="guide-step">
                                    Ordertyp: <span class="guide-value">Market/Limit</span>
                                </div>
                                <div class="guide-step">
                                    Pris: <span class="guide-value" id="guide-buy-price">0 kr</span>
                                </div>
                                <div class="guide-step">
                                    Antal: <span class="guide-value" id="guide-buy-quantity">0 st</span>
                                </div>

                                <h5 class="mt-4 mb-3">Del 2: Sätt Stop Loss</h5>
                                <div class="guide-step">
                                    Trigger: <span class="guide-value" id="guide-buy-sl-trigger">0 kr</span>
                                </div>
                                <div class="guide-step">
                                    Limit: <span class="guide-value" id="guide-buy-sl-limit">0 kr</span>
                                </div>

                                <h5 class="mt-4 mb-3">Del 3: Sätt Take Profit</h5>
                                <div class="guide-step">
                                    Limit: <span class="guide-value" id="guide-buy-tp-limit">0 kr</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Guides Section End -->

    <!-- Footer Start -->
    <div class="container-fluid footer py-5 wow fadeIn" data-wow-delay="0.2s">
        <div class="container py-5">
            <div class="row g-5">
                <div class="col-md-6 col-lg-4">
                    <div class="footer-item">
                        <a href="index.html" class="p-0">
                            <h4 class="text-white"><i class="fas fa-chart-line me-3"></i>Avanza Helper</h4>
                        </a>
                        <p class="text-white-50 mb-4">Professionell Stop Loss & Take Profit kalkylator för seriösa investerare. 100% gratis verktyg.</p>
                    </div>
                </div>
                <div class="col-md-6 col-lg-4">
                    <div class="footer-item">
                        <h4 class="text-white mb-4">Snabblänkar</h4>
                        <a href="#home" class="btn btn-link">Hem</a>
                        <a href="#calculator" class="btn btn-link">Kalkylator</a>
                        <a href="#guides" class="btn btn-link">Guider</a>
                    </div>
                </div>
                <div class="col-md-6 col-lg-4">
                    <div class="footer-item">
                        <h4 class="text-white mb-4">Information</h4>
                        <p class="text-white-50"><i class="fas fa-shield-alt text-primary me-2"></i>100% Gratis Verktyg</p>
                        <p class="text-white-50"><i class="fas fa-calculator text-primary me-2"></i>Exakta Beräkningar</p>
                        <p class="text-white-50"><i class="fas fa-chart-line text-primary me-2"></i>Realtidsdata från Alpha Vantage</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Footer End -->

    <!-- Copyright Start -->
    <div class="container-fluid copyright py-4">
        <div class="container">
            <div class="row g-4 align-items-center">
                <div class="col-md-6 text-center text-md-start mb-md-0">
                    <span class="text-body"><i class="fas fa-copyright text-light me-2"></i>Avanza Trading Helper 2026. Alla rättigheter förbehållna.</span>
                </div>
                <div class="col-md-6 text-center text-md-end text-body">
                    Byggd med ❤️ för svenska investerare
                </div>
            </div>
        </div>
    </div>
    <!-- Copyright End -->

    <!-- Back to Top -->
    <a href="#" class="btn btn-primary btn-lg-square rounded-circle back-to-top"><i class="fa fa-arrow-up"></i></a>

    <!-- JavaScript Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // ============================================
        // CONFIGURATION & DATA
        // ============================================
        
        let currentStock = null;
        let calculatedData = null;
        let selectedRisk = 1;
        let currentChart = null;
        let chartPeriod = '30';
        
        const riskLevels = {
            1: { stopLoss: 0.01, takeProfit: 0.02 },
            2: { stopLoss: 0.02, takeProfit: 0.04 },
            3: { stopLoss: 0.03, takeProfit: 0.06 },
            4: { stopLoss: 0.04, takeProfit: 0.08 },
            5: { stopLoss: 0.05, takeProfit: 0.10 }
        };
        
        // ============================================
        // SPINNER
        // ============================================
        
        window.addEventListener('load', function() {
            const spinner = document.getElementById('spinner');
            if (spinner) {
                spinner.classList.remove('show');
            }
        });
        
        // ============================================
        // BACK TO TOP
        // ============================================
        
        const backToTop = document.querySelector('.back-to-top');
        
        window.addEventListener('scroll', function() {
            if (window.scrollY > 300) {
                backToTop.style.display = 'flex';
            } else {
                backToTop.style.display = 'none';
            }
        });
        
        backToTop.addEventListener('click', function(e) {
            e.preventDefault();
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });
        
        // ============================================
        // STOCK SEARCH
        // ============================================
        
        async function searchStock() {
            const query = document.getElementById('searchInput').value.trim().toUpperCase();
            
            if (!query) {
                alert('Skriv in en ticker-symbol!');
                return;
            }
            
            const apiKey = 'LHBGOUL4ZLHCV9PW';
            const loadingDiv = document.getElementById('stockResult');
            
            loadingDiv.innerHTML = '<div class="loading-spinner"><div class="spinner-border-custom"></div><p class="mt-3">Hämtar aktuellt pris och historik...</p></div>';
            loadingDiv.classList.add('show');
            
            try {
                // Fetch current price
                const quoteUrl = `https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol=${encodeURIComponent(query)}&apikey=${apiKey}`;
                const proxyUrl = 'https://api.allorigins.win/raw?url=';
                
                const quoteResponse = await fetch(proxyUrl + encodeURIComponent(quoteUrl));
                const quoteData = await quoteResponse.json();
                
                if (quoteData['Error Message']) {
                    throw new Error('Ticker hittades inte. Kontrollera stavningen.');
                }
                
                if (quoteData['Note'] || quoteData['Information']) {
                    throw new Error('API-gräns nådd (25 requests/dag). Vänta och försök igen.');
                }
                
                const quote = quoteData['Global Quote'];
                
                if (!quote || !quote['05. price']) {
                    throw new Error('Ingen data hittades för ' + query);
                }
                
                currentStock = {
                    ticker: quote['01. symbol'] || query,
                    price: parseFloat(quote['05. price']),
                    change: parseFloat(quote['09. change']),
                    changePercent: parseFloat(quote['10. change percent'].replace('%', ''))
                };
                
                // Fetch historical data for chart
                await fetchStockChart(query, apiKey);
                
                displayStockResult();
                
            } catch (error) {
                console.error('API error:', error);
                loadingDiv.innerHTML = `
                    <div class="loading-spinner">
                        <p class="text-danger fw-bold">${error.message}</p>
                        <div class="alert alert-warning mt-3 text-start">
                            <strong>Tips:</strong>
                            <ul class="mb-0 mt-2">
                                <li>Kontrollera att ticker-symbolen är korrekt</li>
                                <li>Prova med USA-aktier: AAPL, TSLA, MSFT, GOOGL</li>
                                <li>Gratis API: max 25 sökningar/dag</li>
                                <li>Eller fyll i pris manuellt nedan</li>
                            </ul>
                        </div>
                        <button class="btn btn-primary mt-3" onclick="document.getElementById('buyPrice').scrollIntoView({behavior: 'smooth'}); document.getElementById('stockResult').classList.remove('show');">
                            Fyll i pris manuellt
                        </button>
                    </div>
                `;
            }
        }
        
        // ============================================
        // FETCH STOCK CHART DATA
        // ============================================
        
        async function fetchStockChart(symbol, apiKey) {
            try {
                const chartUrl = `https://www.alphavantage.co/query?function=TIME_SERIES_DAILY&symbol=${encodeURIComponent(symbol)}&apikey=${apiKey}&outputsize=compact`;
                const proxyUrl = 'https://api.allorigins.win/raw?url=';
                
                const response = await fetch(proxyUrl + encodeURIComponent(chartUrl));
                const data = await response.json();
                
                if (data['Time Series (Daily)']) {
                    const timeSeries = data['Time Series (Daily)'];
                    const dates = Object.keys(timeSeries).reverse().slice(-parseInt(chartPeriod));
                    const prices = dates.map(date => parseFloat(timeSeries[date]['4. close']));
                    
                    currentStock.chartData = {
                        dates: dates,
                        prices: prices
                    };
                }
            } catch (error) {
                console.error('Chart fetch error:', error);
            }
        }
        
        // ============================================
        // DISPLAY STOCK RESULT WITH CHART
        // ============================================
        
        function displayStockResult() {
            const s = currentStock;
            const changeColor = s.change >= 0 ? 'positive' : 'negative';
            const changeSign = s.change >= 0 ? '+' : '';
            
            let chartHTML = '';
            if (s.chartData) {
                chartHTML = `
                    <div class="text-center mb-3">
                        <button class="period-btn ${chartPeriod === '7' ? 'active' : ''} me-2" onclick="changeChartPeriod('7')">7D</button>
                        <button class="period-btn ${chartPeriod === '30' ? 'active' : ''} me-2" onclick="changeChartPeriod('30')">30D</button>
                        <button class="period-btn ${chartPeriod === '90' ? 'active' : ''}" onclick="changeChartPeriod('90')">90D</button>
                    </div>
                    <div class="chart-container">
                        <canvas id="stockChart"></canvas>
                    </div>
                `;
            }
            
            const html = `
                <div class="row align-items-center mb-4">
                    <div class="col-md-4 text-center text-md-start">
                        <div class="stock-ticker">${s.ticker}</div>
                    </div>
                    <div class="col-md-4 text-center">
                        <div class="stock-price">$${s.price.toFixed(2)}</div>
                    </div>
                    <div class="col-md-4 text-center text-md-end">
                        <div class="stock-change ${changeColor}">
                            ${changeSign}${s.change.toFixed(2)} (${changeSign}${s.changePercent.toFixed(2)}%)
                        </div>
                    </div>
                </div>
                ${chartHTML}
                <button class="btn btn-primary w-100 mt-3" onclick="useStockPrice()">
                    <i class="fas fa-check-circle me-2"></i>Använd pris $${s.price.toFixed(2)} i kalkylatorn
                </button>
            `;
            
            document.getElementById('stockResult').innerHTML = html;
            document.getElementById('stockResult').classList.add('show');
            
            if (s.chartData) {
                setTimeout(() => renderChart(), 100);
            }
        }
        
        // ============================================
        // RENDER CHART
        // ============================================
        
        function renderChart() {
            const canvas = document.getElementById('stockChart');
            if (!canvas || !currentStock.chartData) return;
            
            const ctx = canvas.getContext('2d');
            
            if (currentChart) {
                currentChart.destroy();
            }
            
            currentChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: currentStock.chartData.dates,
                    datasets: [{
                        label: currentStock.ticker + ' Pris',
                        data: currentStock.chartData.prices,
                        borderColor: '#00D084',
                        backgroundColor: 'rgba(0, 208, 132, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointRadius: 0,
                        pointHoverRadius: 6,
                        pointHoverBackgroundColor: '#00D084',
                        pointHoverBorderColor: '#FFFFFF',
                        pointHoverBorderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            backgroundColor: 'rgba(13, 31, 45, 0.95)',
                            titleColor: '#FFFFFF',
                            bodyColor: '#00D084',
                            borderColor: '#00D084',
                            borderWidth: 1,
                            padding: 12,
                            displayColors: false,
                            callbacks: {
                                label: function(context) {
                                    return '$' + context.parsed.y.toFixed(2);
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            display: true,
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)',
                                drawBorder: false
                            },
                            ticks: {
                                color: '#B0B0B0',
                                maxTicksLimit: 8
                            }
                        },
                        y: {
                            display: true,
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)',
                                drawBorder: false
                            },
                            ticks: {
                                color: '#B0B0B0',
                                callback: function(value) {
                                    return '$' + value.toFixed(2);
                                }
                            }
                        }
                    },
                    interaction: {
                        mode: 'nearest',
                        axis: 'x',
                        intersect: false
                    }
                }
            });
        }
        
        // ============================================
        // CHANGE CHART PERIOD
        // ============================================
        
        async function changeChartPeriod(period) {
            chartPeriod = period;
            
            if (currentStock && currentStock.ticker) {
                const apiKey = 'LHBGOUL4ZLHCV9PW';
                await fetchStockChart(currentStock.ticker, apiKey);
                displayStockResult();
            }
        }
        
        // ============================================
        // USE STOCK PRICE
        // ============================================
        
        function useStockPrice() {
            if (currentStock) {
                document.getElementById('buyPrice').value = currentStock.price.toFixed(2);
                document.getElementById('buyPrice').scrollIntoView({ behavior: 'smooth' });
                
                // Visual feedback
                const input = document.getElementById('buyPrice');
                input.style.borderColor = '#00D084';
                input.style.boxShadow = '0 0 0 0.2rem rgba(0, 208, 132, 0.25)';
                setTimeout(() => {
                    input.style.borderColor = '';
                    input.style.boxShadow = '';
                }, 1500);
            }
        }
        
        // ============================================
        // RISK SELECTOR
        // ============================================
        
        function selectRisk(level) {
            selectedRisk = level;
            
            document.querySelectorAll('.risk-option').forEach(option => {
                option.classList.remove('active');
            });
            
            event.currentTarget.classList.add('active');
        }
        
        // ============================================
        // CALCULATE
        // ============================================
        
        function calculate() {
            const buyPrice = parseFloat(document.getElementById('buyPrice').value);
            const quantity = parseInt(document.getElementById('quantity').value);
            
            if (!buyPrice || !quantity) {
                alert('Fyll i Inköpspris och Antal!');
                return;
            }
            
            const risk = riskLevels[selectedRisk];
            const totalInvestment = buyPrice * quantity;
            
            const slTrigger = buyPrice * (1 - risk.stopLoss);
            const slLimit = slTrigger * 0.98;
            const maxLoss = totalInvestment * risk.stopLoss;
            
            const tpLimit = buyPrice * (1 + risk.takeProfit);
            const maxProfit = totalInvestment * risk.takeProfit;
            
            const ratio = (maxProfit / maxLoss).toFixed(2);
            
            calculatedData = {
                buyPrice,
                quantity,
                totalInvestment,
                slTrigger,
                slLimit,
                maxLoss,
                tpLimit,
                maxProfit,
                ratio
            };
            
            updateDisplays();
            
            document.getElementById('results').classList.add('show');
            document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
        }
        
        // ============================================
        // UPDATE DISPLAYS
        // ============================================
        
        function updateDisplays() {
            const d = calculatedData;
            
            document.getElementById('totalInvestment').textContent = d.totalInvestment.toFixed(2) + ' kr';
            document.getElementById('slTrigger').textContent = d.slTrigger.toFixed(2) + ' kr';
            document.getElementById('slLimit').textContent = d.slLimit.toFixed(2) + ' kr';
            document.getElementById('maxLoss').textContent = '-' + d.maxLoss.toFixed(2) + ' kr';
            document.getElementById('tpLimit').textContent = d.tpLimit.toFixed(2) + ' kr';
            document.getElementById('maxProfit').textContent = '+' + d.maxProfit.toFixed(2) + ' kr';
            document.getElementById('ratio').textContent = '1:' + d.ratio;
            
            document.getElementById('guide-sl-trigger').textContent = d.slTrigger.toFixed(2) + ' kr';
            document.getElementById('guide-sl-limit').textContent = d.slLimit.toFixed(2) + ' kr';
            document.getElementById('guide-sl-quantity').textContent = d.quantity + ' st';
            
            document.getElementById('guide-tp-limit').textContent = d.tpLimit.toFixed(2) + ' kr';
            document.getElementById('guide-tp-quantity').textContent = d.quantity + ' st';
            
            document.getElementById('guide-buy-quantity').textContent = d.quantity + ' st';
            document.getElementById('guide-buy-price').textContent = d.buyPrice.toFixed(2) + ' kr';
            document.getElementById('guide-buy-sl-trigger').textContent = d.slTrigger.toFixed(2) + ' kr';
            document.getElementById('guide-buy-sl-limit').textContent = d.slLimit.toFixed(2) + ' kr';
            document.getElementById('guide-buy-tp-limit').textContent = d.tpLimit.toFixed(2) + ' kr';
        }
        
        // ============================================
        // ENTER KEY SUPPORT
        // ============================================
        
        document.getElementById('searchInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchStock();
            }
        });
    </script>
</body>
</html>
